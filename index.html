<html>
<head>
    <title>Английский язык</title>
    <style>
        .header{
            height: 15%;
            width: 80%;
            font-size: 3em;
            display: flex;
            background: transparent;
        }
        .major{
            z-index: 1;
        }
        .listOfLessons{
            float: left;
            height: 85%;
            width: 16%;
            display: block;
        }
        .textPart{
            display: inline-block;
            float: left;
            height: 85%;
            width: 50%;

        }
        .kdpv{
            display: inline-block;
            width: 32%;
            float: right;
            margin-top: -130px;

        }

        .lessonBody{
            display: flex;
            height: 50%;
            width: 50%;
            float: left;
        }
        .image{
            position: relative;
            display: block;
            float: left;
            margin-top: 80px;
            height: 1000px;
            z-index: -1

            
            
        }
        .arrow{
            display: flex;
            height: 100%;
            width: 12.5%;
            float: left;
            margin: auto;
            font-size: 72px;
            text-align: center;

        }
        .word{
            display: flex;
            height: auto;
            width: auto;
            border: 1px white;
            float: left;
            margin: auto;
            font-size: 77px;

        }
        .lessonTitle{
            font-size: 26px;
            display: flex;
            width: 30%;

        }
        .testTable{
            display: inline-block;
            margin: auto;
        }
        .clickerText{
            margin: auto;
            text-align: center;

        }
        .tableCell{
            display: inline-block;
            border: 4px double black;

        }
        .innerCell
        {
            display: inline-block;
            margin: auto;
        }
	table.lessonTable{
            font-size: 26px;
	    margin-top: 100px;
        z-index: 100;

        }
    </style>

</head>
<body>
<div id = "header" class="header">
     <div class="image"> <img src="res/logo.png" height="90px" /></div>
    <div style="margin: auto">Английский язык     </div>
</div>
<div id = "major" class="major">
    <div id = "listOfLessons" class="listOfLessons">
      <table class="lessonTable">
          <tr><td onclick="openLsn(1)">Урок 1</td></tr>
          <tr><td onclick="openLsn(2)">Урок 2</td></tr>
          <tr><td onclick="openLsn(3)">Урок 3</td></tr>
          <tr><td onclick="openLsn(4)">Урок 4</td></tr>
          <tr><td onclick="openLsn(5)">Урок 5</td></tr>
          <tr><td onclick="openLsn(6)">Урок 6</td></tr>
          <tr><td onclick="openLsn(7)">Урок 7</td></tr>
          <tr><td onclick="openLsn(8)">Урок 8</td></tr>
          <tr><td onclick="openLsn(9)">Урок 9</td></tr>
          <tr><td onclick="openLsn(10)">Урок 10</td></tr>


      </table>
    </div>
    <div id="textPart" class="textPart">
        <p>Для облегчения взаимодействия людей, разговаривающих на разных языках, общесво использует переводчики.</p>
        <p>На протяжении многих лет это были обычные бумажные словари, однако с развитием технологий появились приложения, которые способны переводить текст автоматически. Электронные переводчики имеют неоспоримые преимущества по сравнению с их бумажными предшественниками.
Теперь не обязательно иметь печатный словарь,  телефон всегда с собой, и нет ограничений, где Вы находитесь и на какой язык хотите перевести слова, текст или даже предложения. Именно поэтому онлайн-переводчики пользуются такой популярностью.
Они основаны на машинном переводе, то есть, онлайн-переводчик дает перевод текста с одного языка на другой с помощью определенной компьютерной программы.</p>
      <p>Первые системы МП характеризуются стратегией прямого перевода. Сущность этого подхода к построению МП заключается в том, что исходный текст на входном языке постепенно через ряд этапов преобразуется в текст выходного языка. Преобразования сводятся к тому, что слово на входном языке заменяется на его словарный эквивалент на выходном языке. Для работы таких систем вполне достаточно правил словарных соответствий. В редких случаях проводится анализ контекста для перевода неоднозначных  выражений, опять-таки представленных в словаре системы. Важно иметь в виду, что стратегия прямого перевода не делает различий между анализом и синтезом, поскольку они фактически исключены из преобразований по правилам словарных соответствий. Прямой перевод всегда привязан к конкретной паре языков. Например, неоднозначность выражений входного языка разрешается только в той степени, в которой это оказывается необходимым для выходного языка. По временным рамкам системы первого поколения в основном создавались в период с конца 40-х до середины 60-х гг. 10 Существенная модификация стратегии прямого перевода обнаруживается в системах с трансфером — этапом межъязыковых операций, не сводимых только к замене лексем входного языка на словарные соответствия выходного языка. Наличие этапа трансфера предполагает построение «промежуточного» или «внутреннего» представления, которое далее «приспосабливается» к структуре предложения выходного языка. В отличие от первой стратегии, в архитектуре систем МП с трансфером анализ  и синтез существуют как особые процедуры и обслуживаются различными алгоритмами. Развитие идеи трансфера привело к появлению перевода, основанного на глубинном лингвистическом анализе. Данная стратегия подразумевает анализ входного текста на всех языковых уровнях, а также многоуровневый синтез выходного текста. Критика стратегии прямого перевода привела к созданию стратегии интерлингвы. Главная особенность этой стратегии заключаются в том, что между структурами входного языка и структурами выходного языка находится один или несколько промежуточных языков, на которые по соответствующим правилам последовательно «переписываются» выражения входного языка. Анализ и синтез при использовании языка-посредника принципиально разделяются. Анализ ведется в категориях входного языка, а синтез — в категориях выходного. В качестве языков-посредников могут выступать языки представления синтаксической и семантико-синтаксической структуры, чисто семантические языки, языки глубинной семантики, приближающиеся к концептуальному представлению в категориях теории знаний. В последнее время получила развитие стратегия памяти переводов. Память переводов — база данных, содержащая набор ранее переведенных текстов. Одна запись в такой базе данных соответствует «единице перевода», за которую обычно принимается одно предложение. Если очередное предложение исходного текста в точности совпадает с предложением, хранящимся в базе, оно может быть автоматически подставлено в перевод. Новое предложение может также слегка отличаться от хранящегося в базе. Такое предложение может быть также подставлено в перевод, но переводчик будет должен внести необходимые изменения.</p>
        <p>Однако при при использовании машинного перевода всё ещё можно встретить большое количество ошибок. В особенности эти ошибки наблюдаются при переводе художественных произведений, образных выражений, идиом и фразеологизмов. </p>
        

    
    </div>
    <div id = "kdpv" class="kdpv">
            <img id="kdpvImage" src="res/image.bmp" class="image"/>
    </div>
</div>

<script>

    function shuffle(array) {
        let currentIndex = array.length, temporaryValue, randomIndex;

        // While there remain elements to shuffle...
        while (0 !== currentIndex) {

            // Pick a remaining element...
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex -= 1;

            // And swap it with the current element.
            temporaryValue = array[currentIndex];
            array[currentIndex] = array[randomIndex];
            array[randomIndex] = temporaryValue;
        }

        return array;
    }

    let lessons;
    fetch("res/lesson_1.json").then(async (response) => {
        const data = await response.json();
        lessons = data;
    })

    var textStyle = document.getElementById("textPart").getAttribute("style");


    function chech(map, clicked, prevClicked) {

        console.log(map.get(prevClicked) + "___"+ clicked);
        console.log(map.get(clicked) + "____"+prevClicked);

        if ((map.get(prevClicked) === clicked) || (map.get(clicked) === prevClicked)) {
            let updArr = document.getElementsByClassName("innerCell");
            for (let i = 0; i < updArr.length-1; i++)
            {
                if (updArr[i].innerHTML.indexOf(clicked) >-1)
                    updArr[i].setAttribute("style", "background-color:green");

                if (updArr[i].innerHTML.indexOf(prevClicked) >-1)
                    updArr[i].setAttribute("style", "background-color:green");
            }
        }
    }


    function openLsn(number) {
        let map = new Map();
        document.getElementById("kdpvImage").setAttribute("src", "res/kdpvLsn.bmp");
        let lesson = lessons.Lessons["Lesson_"+number];
        console.log(lesson);
        let iter = 1;
        let spinned = 0;
        if (document.getElementById("lesson"))
            document.getElementById("lesson").parentNode.removeChild(document.getElementById("lesson"));
        let el = document.getElementById('textPart');
        let parentEl = el.parentNode;
        let startWord = Object.keys(lessons["Lessons"]["Lesson_"+number][iter])[0];
        newEl = document.createElement('div');
        newEl.setAttribute("id", "lesson");
        newEl.setAttribute("class", "lesson");

            newEl.innerHTML = "<div class='lessonTitle'><div class='clickerText'> Lesson number " + number +
                "</div>" +"</div>" +
                "<div class='lessonBody'> " +
                "<div id='prev' class='arrow'><div class='clickerText'><</div>" +
                "</div>" +
                "<div id='word' class='word'> <div class='clickerText'>"+startWord+"</div>" +
                "</div>" +
                "<div id='next' class='arrow'><div class='clickerText'>></div>" +
                "</div>" +
                "</div>";
            ;

        parentEl.insertBefore(newEl, el);
        document.getElementById("textPart").setAttribute("style", textStyle + "; display: none;");
        document.getElementById("word").onclick = function () {
            if (spinned%2)
            {
                let word = Object.keys(lessons["Lessons"]["Lesson_"+number][iter])[0];
                document.getElementById("word").innerHTML = " <div class='clickerText'>"+word+"</div>";
                spinned++;
            }
            else
            {
                let word = Object.values(lessons["Lessons"]["Lesson_"+number][iter])[0];

                document.getElementById("word").innerHTML = " <div class='clickerText'>"+word+"</div>";
                spinned--;
            }
        };

        document.getElementById("prev").onclick = ()=>{
            if (iter === 1){
            }
            else {
                iter--;
                document.getElementById("word").innerHTML = " <div class='clickerText'>"+Object.keys(lessons["Lessons"]["Lesson_"+number][iter])[0]+"</div>";
            }
        }
        document.getElementById("next").onclick = ()=>{
            map.set(Object.keys(lessons["Lessons"]["Lesson_"+number][iter])[0], Object.values(lessons["Lessons"]["Lesson_"+number][iter])[0]);
            if (iter === 9){
                alert("Lesson have been finished")
                drawTable(map);
            }
            else {
                iter++;
                document.getElementById("word").innerHTML = " <div class='clickerText'>"+Object.keys(lessons["Lessons"]["Lesson_"+number][iter])[0]+"</div>";
            }
        }
    }

    document.getElementById("header").onclick =  ()=> {
        document.getElementById("kdpvImage").setAttribute("src", "res/image.bmp");
        if (document.getElementById("lesson"))
            document.getElementById("lesson").parentNode.removeChild(document.getElementById("lesson"));
        document.getElementById("textPart").removeAttribute("style");
    };

    document.addEventListener('keydown', function(event) {
        if (event.code === 'ArrowRight') {
            document.getElementById("next").onclick();
        }
        if (event.code === 'ArrowLeft') {
            document.getElementById("prev").onclick();
        }
    });



    function drawTable(map) {

        console.log(map)
        let finalArray = new Array();
        let arrOfKeys = Array.from(map.keys());
        for (let i of arrOfKeys)
        {
            console.log(i)
            console.log(map.get(i))
        }
        for (let i = 0; i< 6; i++)
        {
            let key = arrOfKeys[Math.floor(Math.random()*arrOfKeys.length)];
            finalArray.push(key);
            finalArray.push(map.get(key));
            arrOfKeys.splice(arrOfKeys.indexOf(key), 1);
        }
        finalArray = shuffle(finalArray);
        console.log(finalArray);
        let innerhtml = "";
        innerhtml+="<div class = 'testTable'><table>"
        for (let i =0; i<4; i++)
        {
            innerhtml+="<tr>"
            for (let j =0; j< 3; j++)
            {
                innerhtml+="<td class='tableCell'>";
                innerhtml+="<div class = 'innerCell'>";
                innerhtml+=finalArray[4*j+i];
                innerhtml+="</div>";
                innerhtml+="</td>";
            }
            innerhtml+="</td>"
        }
        innerhtml+="</table></div>";
        document.getElementsByClassName("lessonBody")[0].innerHTML = innerhtml;

        let prevclicked = "1";
        document.addEventListener("click",   (e)=>{
            chech(map, e.target.innerText, prevclicked);
            prevclicked= e.target.innerText;
        });
    }


</script>
</body>
</html>